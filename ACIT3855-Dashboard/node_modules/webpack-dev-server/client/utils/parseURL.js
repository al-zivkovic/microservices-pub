import getCurrentScriptSource from "./getCurrentScriptSource.js";
<<<<<<< HEAD

=======
>>>>>>> 673f6c3a713c3c5a521125c5e4ea6135afefe034
/**
 * @param {string} resourceQuery
 * @returns {{ [key: string]: string | boolean }}
 */
<<<<<<< HEAD
function parseURL(resourceQuery) {
  /** @type {{ [key: string]: string }} */
  var options = {};
  if (typeof resourceQuery === "string" && resourceQuery !== "") {
    var searchParams = resourceQuery.slice(1).split("&");
=======

function parseURL(resourceQuery) {
  /** @type {{ [key: string]: string }} */
  var options = {};

  if (typeof resourceQuery === "string" && resourceQuery !== "") {
    var searchParams = resourceQuery.slice(1).split("&");

>>>>>>> 673f6c3a713c3c5a521125c5e4ea6135afefe034
    for (var i = 0; i < searchParams.length; i++) {
      var pair = searchParams[i].split("=");
      options[pair[0]] = decodeURIComponent(pair[1]);
    }
  } else {
    // Else, get the url from the <script> this file was called with.
    var scriptSource = getCurrentScriptSource();
    var scriptSourceURL;
<<<<<<< HEAD
=======

>>>>>>> 673f6c3a713c3c5a521125c5e4ea6135afefe034
    try {
      // The placeholder `baseURL` with `window.location.href`,
      // is to allow parsing of path-relative or protocol-relative URLs,
      // and will have no effect if `scriptSource` is a fully valid URL.
      scriptSourceURL = new URL(scriptSource, self.location.href);
<<<<<<< HEAD
    } catch (error) {
      // URL parsing failed, do nothing.
      // We will still proceed to see if we can recover using `resourceQuery`
    }
=======
    } catch (error) {// URL parsing failed, do nothing.
      // We will still proceed to see if we can recover using `resourceQuery`
    }

>>>>>>> 673f6c3a713c3c5a521125c5e4ea6135afefe034
    if (scriptSourceURL) {
      options = scriptSourceURL;
      options.fromCurrentScript = true;
    }
  }
<<<<<<< HEAD
  return options;
}
=======

  return options;
}

>>>>>>> 673f6c3a713c3c5a521125c5e4ea6135afefe034
export default parseURL;