const babel = require("./babel-core.cjs");
<<<<<<< HEAD
const convert = require("../convert/index.cjs");
=======

const convert = require("../convert/index.cjs");

>>>>>>> 673f6c3a713c3c5a521125c5e4ea6135afefe034
const {
  getVisitorKeys,
  getTokLabels
} = require("./ast-info.cjs");
<<<<<<< HEAD
const extractParserOptionsPlugin = require("./extract-parser-options-plugin.cjs");
const ref = {};
let extractParserOptionsConfigItem;
const MULTIPLE_OVERRIDES = /More than one plugin attempted to override parsing/;
=======

const extractParserOptionsPlugin = require("./extract-parser-options-plugin.cjs");

const ref = {};
let extractParserOptionsConfigItem;
const MULTIPLE_OVERRIDES = /More than one plugin attempted to override parsing/;

>>>>>>> 673f6c3a713c3c5a521125c5e4ea6135afefe034
module.exports = function maybeParse(code, options) {
  if (!extractParserOptionsConfigItem) {
    extractParserOptionsConfigItem = babel.createConfigItem([extractParserOptionsPlugin, ref], {
      dirname: __dirname,
      type: "plugin"
    });
  }
<<<<<<< HEAD
=======

>>>>>>> 673f6c3a713c3c5a521125c5e4ea6135afefe034
  const {
    plugins
  } = options;
  options.plugins = plugins.concat(extractParserOptionsConfigItem);
<<<<<<< HEAD
=======

>>>>>>> 673f6c3a713c3c5a521125c5e4ea6135afefe034
  try {
    return {
      parserOptions: babel.parseSync(code, options),
      ast: null
    };
  } catch (err) {
    if (!MULTIPLE_OVERRIDES.test(err.message)) {
      throw err;
    }
  }
<<<<<<< HEAD
  options.plugins = plugins;
  let ast;
=======

  options.plugins = plugins;
  let ast;

>>>>>>> 673f6c3a713c3c5a521125c5e4ea6135afefe034
  try {
    ast = babel.parseSync(code, options);
  } catch (err) {
    throw convert.error(err);
  }
<<<<<<< HEAD
=======

>>>>>>> 673f6c3a713c3c5a521125c5e4ea6135afefe034
  return {
    ast: convert.ast(ast, code, getTokLabels(), getVisitorKeys()),
    parserOptions: null
  };
};

//# sourceMappingURL=maybeParse.cjs.map
